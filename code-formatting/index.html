<!DOCTYPE html>
<html>
<head>
  <title>HTML整形ツール</title>
</head>
<body>
  <h1>HTML整形ツール</h1>
  <form id="htmlForm">
    <label for="htmlSource">整形前のHTMLソース:</label><br>
    <textarea id="htmlSource" rows="15" cols="80" placeholder="ここに整形前のHTMLソースを入力してください"></textarea><br>
    <button type="button" onclick="formatHTML()">整形する</button>
  </form>
  
  <h2>整形されたHTML:</h2>
  <pre id="formatted-html"></pre>
  
  <h2>整形されたCSS:</h2>
  <pre id="formatted-css"></pre>
  
  <script>
    function formatHTML() {
      const compressedHTML = document.getElementById("htmlSource").value;
      
      // 開始タグと閉じタグの両方で改行を追加する関数
      function addNewlines(html) {
        const regex = /(<(\/)?div[^>]*>)/g;
        return html.replace(regex, "\n$1");
      }

      // インラインスタイルを分離する関数
      function separateInlineStyles(html) {
        const regex = /<(div)[^>]*(id)=["']([^"']+)["'][^>]*style=["']([^"']+)["']/g;
        let css = "";
        const separatedHTML = html.replace(regex, function(match, element, attribute, name, style) {
          const separated = match.replace(/(style=["'][^"']+["'])/, "");
          css += `#${name} {\n${style}\n}\n`;
          return separated;
        });
        return { separatedHTML, css };
      }

      let { separatedHTML, css } = separateInlineStyles(compressedHTML);

      document.getElementById("formatted-html").textContent = addNewlines(separatedHTML);
      document.getElementById("formatted-css").textContent = css;
    }
  </script>
</body>
</html>